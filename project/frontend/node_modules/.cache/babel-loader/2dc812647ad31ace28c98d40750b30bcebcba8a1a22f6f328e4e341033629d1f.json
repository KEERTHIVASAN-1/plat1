{"ast":null,"code":"// src/utils/api.js\nimport axios from 'axios';\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8000';\nconst apiClient = axios.create({\n  baseURL: BACKEND_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 30000\n});\n\n// Attach token if exists\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem('token') || localStorage.getItem('access_token');\n  if (token) config.headers.Authorization = `Bearer ${token}`;\n  return config;\n}, err => Promise.reject(err));\n\n// Handle auth failure globally\napiClient.interceptors.response.use(r => r, error => {\n  var _error$response;\n  if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    // optional: redirect or let app handle\n    if (window && window.location) window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\nexport const api = {\n  // auth\n  login: (email, password) => apiClient.post('/auth/login', {\n    email,\n    password\n  }),\n  register: (name, email, password) => apiClient.post('/auth/register', {\n    name,\n    email,\n    password\n  }),\n  // contest\n  getRoundWindow: roundId => apiClient.get('/timer/window', {\n    params: {\n      roundId\n    }\n  }),\n  getProblems: () => apiClient.get('/problems'),\n  getProblem: problemId => apiClient.get(`/problems/${problemId}`),\n  runCode: data => apiClient.post('/run', data),\n  submitCode: data => apiClient.post('/submit', data),\n  getUserSubmissions: userId => apiClient.get(`/submissions/${userId}`),\n  // admin helpers (if backend supports)\n  getParticipants: () => apiClient.get('/admin/participants'),\n  addProblem: data => apiClient.post('/admin/problem', data),\n  updateProblem: (id, data) => apiClient.put(`/admin/problem/${id}`, data),\n  deleteProblem: id => apiClient.delete(`/admin/problem/${id}`)\n};\nexport default apiClient;","map":{"version":3,"names":["axios","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","apiClient","create","baseURL","headers","timeout","interceptors","request","use","config","token","localStorage","getItem","Authorization","err","Promise","reject","response","r","error","_error$response","status","removeItem","window","location","href","api","login","email","password","post","register","name","getRoundWindow","roundId","get","params","getProblems","getProblem","problemId","runCode","data","submitCode","getUserSubmissions","userId","getParticipants","addProblem","updateProblem","id","put","deleteProblem","delete"],"sources":["D:/plat1/project/frontend/src/utils/api.js"],"sourcesContent":["// src/utils/api.js\nimport axios from 'axios';\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8000';\n\nconst apiClient = axios.create({\n  baseURL: BACKEND_URL,\n  headers: { 'Content-Type': 'application/json' },\n  timeout: 30000,\n});\n\n// Attach token if exists\napiClient.interceptors.request.use((config) => {\n  const token = localStorage.getItem('token') || localStorage.getItem('access_token');\n  if (token) config.headers.Authorization = `Bearer ${token}`;\n  return config;\n}, (err) => Promise.reject(err));\n\n// Handle auth failure globally\napiClient.interceptors.response.use((r) => r, (error) => {\n  if (error?.response?.status === 401) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    // optional: redirect or let app handle\n    if (window && window.location) window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\n\nexport const api = {\n  // auth\n  login: (email, password) => apiClient.post('/auth/login', { email, password }),\n  register: (name, email, password) => apiClient.post('/auth/register', { name, email, password }),\n\n  // contest\n  getRoundWindow: (roundId) => apiClient.get('/timer/window', { params: { roundId } }),\n  getProblems: () => apiClient.get('/problems'),\n  getProblem: (problemId) => apiClient.get(`/problems/${problemId}`),\n  runCode: (data) => apiClient.post('/run', data),\n  submitCode: (data) => apiClient.post('/submit', data),\n  getUserSubmissions: (userId) => apiClient.get(`/submissions/${userId}`),\n\n  // admin helpers (if backend supports)\n  getParticipants: () => apiClient.get('/admin/participants'),\n  addProblem: (data) => apiClient.post('/admin/problem', data),\n  updateProblem: (id, data) => apiClient.put(`/admin/problem/${id}`, data),\n  deleteProblem: (id) => apiClient.delete(`/admin/problem/${id}`),\n};\n\nexport default apiClient;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}